import os
from google.colab import files
uploaded = files.upload()
from glob import glob
import numpy as np
import pandas as pd
import cv2
from skimage.feature import graycomatrix as greycomatrix, graycoprops as greycoprops
def preprocess_image(img_path):   #Reads image, converts to grayscale, and resizes.
    img = cv2.imread(img_path)
    img = cv2.cvtColor(img, cv2.COLOR_BGR2GRAY)
    img = cv2.resize(img, (256, 256))
    return img
def extract_histogram(img):  #Extracts normalized grayscale histogram features.
    hist = cv2.calcHist([img], [0], None, [16], [0, 16])
    hist = cv2.normalize(hist, hist).flatten()
    return hist
def extract_glcm_features(img): #Extracts texture features using GLCM.
    glcm = greycomatrix(img, distances=[1], angles=[0], symmetric=True, normed=True)
    contrast = greycoprops(glcm, 'contrast')[0, 0]
    dissimilarity = greycoprops(glcm, 'dissimilarity')[0, 0]
    homogeneity = greycoprops(glcm, 'homogeneity')[0, 0]
    energy = greycoprops(glcm, 'energy')[0, 0]
    correlation = greycoprops(glcm, 'correlation')[0, 0]
    asm = greycoprops(glcm, 'ASM')[0, 0]

    return {
        'contrast': contrast,
        'dissimilarity': dissimilarity,
        'homogeneity': homogeneity,
        'energy': energy,
        'correlation': correlation,
        'ASM': asm
    }
def extract_features_from_folder(folder_path):
    image_paths = glob(os.path.join(folder_path, '*.png'))
    feature_list = []
    for img_path in image_paths:
        img = preprocess_image(img_path)
        hist = extract_histogram(img)
        glcm_feats = extract_glcm_features(img)
        features = {'image_path': img_path}
        features.update({f'hist_{i}': val for i, val in enumerate(hist)})
        features.update(glcm_feats)
        feature_list.append(features)
    return pd.DataFrame(feature_list)
folder_path = "/content/drive/MyDrive/images"
features_df = extract_features_from_folder(folder_path)
features_df.to_csv('extracted_features.csv', index=False)
print("Features extracted and saved to extracted_features.csv")
features_df.head()
